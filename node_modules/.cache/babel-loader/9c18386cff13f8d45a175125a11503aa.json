{"ast":null,"code":"import _slicedToArray from \"/home/mandeep/Downloads/Song-sorch work/site/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _classCallCheck from \"/home/mandeep/Downloads/Song-sorch work/site/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/mandeep/Downloads/Song-sorch work/site/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/home/mandeep/Downloads/Song-sorch work/site/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/mandeep/Downloads/Song-sorch work/site/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\n\nvar _jsxFileName = \"/home/mandeep/Downloads/Song-sorch work/site/src/Song.js\",\n    _this = this,\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$(),\n    _s4 = $RefreshSig$();\n\nimport React, { useEffect, useState, useRef } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { Waypoint } from \"react-waypoint\";\nimport { Helmet } from \"react-helmet\";\nimport { Loading, SetHTMLHeaders, isServer, YouTubeSnippet, SpotifySnippet, IntersectionLazy, // loadCarbonScript,\nloadAdsenseScript, loadAmplifiedScript, RenderParagraphs, ServerError, AmazonRelatedProducts } from \"./Common\";\nimport { cachedFetch } from \"./Cache\";\nimport { SongComments } from \"./Comments\";\nimport \"./Song.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nvar PUBLIC_URL = process.env.PUBLIC_URL || \"\";\nvar placeholderImage = PUBLIC_URL + \"/static/placeholder.png\";\nvar skullImage = PUBLIC_URL + \"/static/skull.png\";\nvar NO_ADS = process.env.REACT_APP_NO_ADS === \"true\";\n\nvar AdTag = function AdTag(props) {\n  _s();\n\n  useEffect(function () {\n    if (window.cf_async === undefined) {\n      window.cf_async = false;\n    }\n\n    document.getElementById(\"inject_ad\");\n    var unique_part = Math.floor(Math.random() * 999999999);\n    var opts = {\n      artist: props.Artistname,\n      song: props.Songname,\n      adunit_id: 100004858,\n      div_id: \"cf_async_\" + unique_part\n    };\n    var cf_div = document.createElement(\"div\");\n    cf_div.setAttribute(\"id\", opts.div_id);\n    document.getElementById(\"inject_ad\").parentNode.setAttribute(\"id\", \"ad_\" + unique_part);\n    document.getElementById(\"ad_\" + unique_part).appendChild(cf_div);\n\n    var c = function c() {\n      cf.showAsyncAd(opts);\n    };\n\n    if (typeof window.cf !== \"undefined\") c();else {\n      cf_async = !0;\n      var r = document.createElement(\"script\"),\n          s = document.getElementsByTagName(\"script\")[0];\n      r.async = !0;\n      r.src = \"//srv.tunefindforfans.com/fruits/apricots.js\";\n      r.readyState ? r.onreadystatechange = function () {\n        if (\"loaded\" == r.readyState || \"complete\" == r.readyState) r.onreadystatechange = null, c();\n      } : r.onload = c;\n      s.parentNode.insertBefore(r, s);\n    }\n  }, []);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"inject_ad\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, _this)\n  }, void 0, false);\n};\n\n_s(AdTag, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\n\n_c = AdTag;\n\nvar Song = /*#__PURE__*/function (_React$Component) {\n  _inherits(Song, _React$Component);\n\n  var _super = _createSuper(Song);\n\n  function Song() {\n    var _this2;\n\n    _classCallCheck(this, Song);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this2 = _super.call.apply(_super, [this].concat(args));\n    _this2.state = {\n      song: _this2.props.song || null,\n      loading: false,\n      notFound: _this2.props.songNotFound || false,\n      serverError: null\n    };\n    return _this2;\n  }\n\n  _createClass(Song, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var match = this.props.match;\n      var id = parseInt(match.params.id, 10);\n\n      if (!this.state.song || this.state.song.id !== id) {\n        if (!this.props.songNotFound) {\n          this.loadSong(id);\n        }\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.dismounted = true;\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var _this3 = this;\n\n      if (this.props.match.params.id !== prevProps.match.params.id) {\n        this.setState({\n          song: null,\n          loading: false,\n          notFound: false,\n          serverError: null\n        }, function () {\n          try {\n            localStorage.removeItem(\"searched\");\n          } catch (ex) {\n            console.warn(\"'localStorage.removeItem(\\\"searched\\\")' didn't work\");\n          }\n\n          _this3.loadSong(_this3.props.match.params.id);\n        });\n      }\n    }\n  }, {\n    key: \"loadSong\",\n    value: function loadSong(id) {\n      var _this4 = this;\n\n      SetHTMLHeaders({\n        title: \"Loading... - Song Search\"\n      });\n\n      if (!isServer) {\n        this.showLoadingSoon = window.setTimeout(function () {\n          if (!_this4.dismounted) {\n            if (!_this4.state.serverError && !_this4.state.notFound && !_this4.state.song && !_this4.state.loading) {\n              _this4.setState({\n                loading: true\n              });\n            }\n          }\n        }, 500);\n      }\n\n      var url = \"/api/song/\".concat(id);\n      var searched = null;\n\n      try {\n        searched = localStorage.getItem(\"searched\");\n      } catch (ex) {\n        console.warn(\"'localStorage.getItem(\\\"searched\\\")' didn't work\");\n      }\n\n      if (searched) {\n        if (searched.includes(\",\")) {\n          // It *used* to be that what was stored in localStorage.searched was just the\n          // search ID. Then in April 2019 this changed to become `ID,timestamp`.\n          // E.g. '92613,1556152340091'. So, we need to deal with handling both\n          // the new and the old.\n          var timestamp = parseInt(searched.split(\",\")[1], 10);\n          var age = (new Date().getTime() - timestamp) / 1000;\n\n          if (age > 3600) {\n            searched = null;\n          } else {\n            searched = searched.split(\",\")[0];\n          }\n        }\n\n        if (searched) {\n          url += \"?searched=\".concat(encodeURIComponent(searched));\n        }\n      }\n\n      return cachedFetch(url).then(function (r) {\n        if (!isServer && _this4.showLoadingSoon) {\n          window.clearTimeout(_this4.showLoadingSoon);\n        }\n\n        if (r.status === 400) {\n          return r.json().then(function (result) {\n            _this4.setState({\n              loading: false\n            });\n\n            if (result.error && result.error === \"redirected\") {\n              if (isServer) {\n                _this4.setState({\n                  notFound: true\n                });\n              } else {\n                document.location.href = result.new_url;\n              }\n            } else {\n              // Some other error\n              _this4.setState({\n                serverError: true\n              });\n            }\n          });\n        } else if (r.status === 404) {\n          _this4.setState({\n            loading: false,\n            notFound: true\n          });\n\n          SetHTMLHeaders({\n            title: \"Not Found\"\n          });\n        } else if (r.status === 500) {\n          _this4.setState({\n            loading: false,\n            serverError: true\n          });\n\n          SetHTMLHeaders({\n            title: \"Song loading error :(\"\n          });\n        } else {\n          return r.json().then(function (result) {\n            if (result && !result.error) {\n              _this4.renderResult(result);\n            } else if (result && result.error) {\n              console.log(\"ERROR:\", result.error);\n            } // if (searched) {\n            //   localStorage.removeItem(\"searched\");\n            // }\n\n\n            return result;\n          });\n        }\n      });\n    }\n  }, {\n    key: \"renderResult\",\n    value: function renderResult(result) {\n      // Make sure this matches server/render.js\n      var title = \"\".concat(result.song.name, \" lyrics by \").concat(result.song.artist.name);\n\n      if (!isServer) {\n        SetHTMLHeaders({\n          title: title,\n          image: result.song.image\n        });\n      }\n\n      this.setState({\n        loading: false,\n        song: result.song\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          loading = _this$state.loading,\n          song = _this$state.song,\n          serverError = _this$state.serverError,\n          notFound = _this$state.notFound;\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [loading && /*#__PURE__*/_jsxDEV(Loading, {\n          text: \"Loading...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 21\n        }, this), song && /*#__PURE__*/_jsxDEV(Result, {\n          song: song\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 18\n        }, this), serverError && !song && /*#__PURE__*/_jsxDEV(ServerError, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 34\n        }, this), notFound && /*#__PURE__*/_jsxDEV(NotFound, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 22\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 7\n      }, this);\n    }\n  }]);\n\n  return Song;\n}(React.Component);\n\nfunction Result(_ref) {\n  var _this5 = this;\n\n  var song = _ref.song;\n  // useEffect(() => {\n  //   // loadCarbonScript();\n  // }, []);\n  var searchedId;\n\n  if (!isServer) {\n    var searched = null;\n\n    try {\n      searched = localStorage.getItem(\"searched\");\n    } catch (ex) {\n      console.warn(\"'localStorage.getItem(\\\"searched\\\")' didn't work\");\n    }\n\n    if (searched) {\n      if (searched.includes(\",\")) {\n        // The new way\n        searchedId = parseInt(searched.split(\",\")[0], 10);\n      } else {\n        // The old way!\n        searchedId = parseInt(searched, 10);\n      }\n    }\n  }\n\n  var comments = null;\n  var commentsCount = null;\n\n  if (song.comments) {\n    comments = song.comments.comments;\n    commentsCount = song.comments.comments_count;\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"result song oka\",\n    children: [/*#__PURE__*/_jsxDEV(RenderSongHead, {\n      song: song\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(RenderParagraphs, {\n      song: song.id,\n      text: song.text_html\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 9\n    }, this), !NO_ADS && /*#__PURE__*/_jsxDEV(AmplifiedSnippet, {\n      song: song\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 274,\n      columnNumber: 21\n    }, this), /*#__PURE__*/_jsxDEV(SongComments, {\n      comments: comments,\n      commentsCount: commentsCount,\n      song: song,\n      searchedId: searchedId\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 276,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(ShareSong, {\n      song: song\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 282,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(AmazonRelatedProducts, {\n      song: song\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 9\n    }, this), !isServer ? /*#__PURE__*/_jsxDEV(IntersectionLazy, {\n      render: function render() {\n        return /*#__PURE__*/_jsxDEV(SpotifySnippet, {\n          song: song\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 285,\n          columnNumber: 43\n        }, _this5);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 11\n    }, this) : null, !isServer ? /*#__PURE__*/_jsxDEV(IntersectionLazy, {\n      render: function render() {\n        return /*#__PURE__*/_jsxDEV(YouTubeSnippet, {\n          song: song\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 288,\n          columnNumber: 43\n        }, _this5);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 11\n    }, this) : null, !isServer ? /*#__PURE__*/_jsxDEV(ShowRelated, {\n      song: song\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 22\n    }, this) : null]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 269,\n    columnNumber: 6\n  }, this);\n}\n\n_c2 = Result;\n\nfunction AmplifiedSnippet(_ref2) {\n  _s2();\n\n  var song = _ref2.song;\n  useEffect(function () {\n    loadAmplifiedScript({\n      song: song.name,\n      artist: song.artist.name\n    });\n  }, [song]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"amplifiedouter\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"null-hide\",\n      id: \"amplified_100003500\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 302,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 301,\n    columnNumber: 5\n  }, this);\n}\n\n_s2(AmplifiedSnippet, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\n\n_c3 = AmplifiedSnippet;\n\nfunction ShareSong(_ref3) {\n  _s3();\n\n  var song = _ref3.song;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      showShare = _useState2[0],\n      setShowShare = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      shared = _useState4[0],\n      setShared = _useState4[1];\n\n  var _useState5 = useState(null),\n      _useState6 = _slicedToArray(_useState5, 2),\n      shareError = _useState6[0],\n      setShareError = _useState6[1];\n\n  useEffect(function () {\n    if (navigator.share) {\n      setShowShare(true);\n    }\n  }, []);\n  if (!showShare) return null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      margin: \"30px 0\",\n      textAlign: \"center\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"btn btn-primary\",\n      onClick: function onClick() {\n        var shareData = {\n          title: song.name,\n          text: \"I found '\".concat(song.name, \"' on Song Search!\"),\n          url: window.location.href\n        };\n\n        try {\n          navigator.share(shareData).then(function () {\n            setShared(true);\n            setShareError(null);\n          }).catch(function (e) {\n            setShareError(e);\n          }).finally(function () {\n            fetch(\"/api/song/\".concat(song.id, \"/shared/\"), {\n              method: \"POST\"\n            });\n          });\n        } catch (err) {\n          setShareError(err);\n        }\n      },\n      children: shared ? \"Thanks!\" : \"Share this song\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 320,\n      columnNumber: 7\n    }, this), shareError && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Sharing failed or was canceled. Oh well.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 350,\n      columnNumber: 22\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 319,\n    columnNumber: 5\n  }, this);\n} // XXX Check if this React.memo works\n\n\n_s3(ShareSong, \"Zte53n6sJ6u/r38P+TghxQja8Nw=\");\n\n_c4 = ShareSong;\nvar RenderSongHead = /*#__PURE__*/React.memo(_c5 = function _c5(_ref4) {\n  var song = _ref4.song;\n  var image = null;\n\n  if (song.image) {\n    image = /*#__PURE__*/_jsxDEV(\"img\", {\n      src: song.image.url,\n      alt: song.image.name,\n      className: \"song-picture\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 360,\n      columnNumber: 7\n    }, _this);\n  } else {\n    image = /*#__PURE__*/_jsxDEV(\"img\", {\n      src: placeholderImage,\n      alt: song.artist.name,\n      width: 150,\n      height: 150\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 368,\n      columnNumber: 7\n    }, _this);\n  }\n\n  var albums = null;\n\n  if (song.albums.length) {\n    var albumNames = song.albums.map(function (a) {\n      if (a.year) {\n        return \"\".concat(a.name, \" (\").concat(a.year, \")\");\n      } else {\n        return a.name;\n      }\n    }).join(\", \");\n    albums = /*#__PURE__*/_jsxDEV(\"h3\", {\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"by\",\n        children: \"on\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 389,\n        columnNumber: 9\n      }, _this), \" \", albumNames]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 388,\n      columnNumber: 7\n    }, _this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center last\",\n      children: [image, /*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"\",\n        children: song.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 397,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"by\",\n          children: \"by\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 399,\n          columnNumber: 11\n        }, _this), \" \", song.artist.name]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 398,\n        columnNumber: 9\n      }, _this), albums, /*#__PURE__*/_jsxDEV(AdTag, {\n        Songname: song.name,\n        Artistname: song.artist.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 402,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 395,\n      columnNumber: 7\n    }, _this)\n  }, void 0, false);\n});\n_c6 = RenderSongHead;\nvar ShowRelated = /*#__PURE__*/React.memo(_c7 = _s4(function (_ref5) {\n  _s4();\n\n  var song = _ref5.song;\n\n  var _useState7 = useState(null),\n      _useState8 = _slicedToArray(_useState7, 2),\n      related = _useState8[0],\n      setRelated = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      loading = _useState10[0],\n      setLoading = _useState10[1];\n\n  var mounted = React.useRef(false);\n  useEffect(function () {\n    if (loading && related) {\n      setLoading(false);\n    }\n  }, [related, loading]);\n\n  function loadRelated() {\n    var url = \"/api/song/\".concat(song.id, \"/related\");\n    return cachedFetch(url).then(function (r) {\n      if (r.ok) {\n        r.json().then(function (result) {\n          if (result && result.categories) {\n            setRelated(result.categories);\n          }\n        });\n      }\n    });\n  }\n\n  var _started = useRef();\n\n  function loadRelatedDebounced() {\n    if (!_started.current) {\n      _started.current = new Date().getTime();\n      loadRelated();\n    }\n  }\n\n  function onEnter() {\n    if (!related && !loading) {\n      loadRelatedDebounced();\n    }\n  }\n\n  useEffect(function () {\n    mounted.current = true;\n    return function () {\n      mounted.current = false;\n    };\n  }, []);\n\n  if (related) {\n    if (!related.length) {\n      return null;\n    }\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"related\",\n      children: related.map(function (category) {\n        return /*#__PURE__*/_jsxDEV(ShowRelatedGroup, {\n          label: category.label,\n          songs: category.results\n        }, category.label, false, {\n          fileName: _jsxFileName,\n          lineNumber: 463,\n          columnNumber: 13\n        }, _this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 460,\n      columnNumber: 7\n    }, _this);\n  } else if (loading) {\n    return null;\n  }\n\n  return /*#__PURE__*/_jsxDEV(Waypoint, {\n    onEnter: onEnter\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 475,\n    columnNumber: 10\n  }, _this);\n}, \"Z6Pabsb80KC46HxaZwvVC7dsa4A=\"));\n_c8 = ShowRelated;\n\nfunction ShowRelatedGroup(_ref6) {\n  var _this6 = this;\n\n  var label = _ref6.label,\n      songs = _ref6.songs;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n      children: label\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 481,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      children: songs.map(function (song) {\n        return /*#__PURE__*/_jsxDEV(\"li\", {\n          children: /*#__PURE__*/_jsxDEV(Link, {\n            to: song._url,\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: song.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 487,\n              columnNumber: 17\n            }, _this6), \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"by\",\n              children: \"by\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 487,\n              columnNumber: 36\n            }, _this6), \" \", song.artist.name]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 486,\n            columnNumber: 15\n          }, _this6)\n        }, song.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 485,\n          columnNumber: 13\n        }, _this6);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 482,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 480,\n    columnNumber: 5\n  }, this);\n}\n\n_c9 = ShowRelatedGroup;\n\nfunction NotFound() {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"not-found\",\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Song Not Found\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 501,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: /*#__PURE__*/_jsxDEV(\"img\", {\n        alt: \"Skull\",\n        src: skullImage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 503,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 502,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/\",\n        children: \"Try another search\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 506,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 505,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 500,\n    columnNumber: 5\n  }, this);\n}\n\n_c10 = NotFound;\nexport default Song;\n\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c10;\n\n$RefreshReg$(_c, \"AdTag\");\n$RefreshReg$(_c2, \"Result\");\n$RefreshReg$(_c3, \"AmplifiedSnippet\");\n$RefreshReg$(_c4, \"ShareSong\");\n$RefreshReg$(_c5, \"RenderSongHead$React.memo\");\n$RefreshReg$(_c6, \"RenderSongHead\");\n$RefreshReg$(_c7, \"ShowRelated$React.memo\");\n$RefreshReg$(_c8, \"ShowRelated\");\n$RefreshReg$(_c9, \"ShowRelatedGroup\");\n$RefreshReg$(_c10, \"NotFound\");","map":{"version":3,"sources":["/home/mandeep/Downloads/Song-sorch work/site/src/Song.js"],"names":["React","useEffect","useState","useRef","Link","Waypoint","Helmet","Loading","SetHTMLHeaders","isServer","YouTubeSnippet","SpotifySnippet","IntersectionLazy","loadAdsenseScript","loadAmplifiedScript","RenderParagraphs","ServerError","AmazonRelatedProducts","cachedFetch","SongComments","PUBLIC_URL","process","env","placeholderImage","skullImage","NO_ADS","REACT_APP_NO_ADS","AdTag","props","window","cf_async","undefined","document","getElementById","unique_part","Math","floor","random","opts","artist","Artistname","song","Songname","adunit_id","div_id","cf_div","createElement","setAttribute","parentNode","appendChild","c","cf","showAsyncAd","r","s","getElementsByTagName","async","src","readyState","onreadystatechange","onload","insertBefore","Song","state","loading","notFound","songNotFound","serverError","match","id","parseInt","params","loadSong","dismounted","prevProps","setState","localStorage","removeItem","ex","console","warn","title","showLoadingSoon","setTimeout","url","searched","getItem","includes","timestamp","split","age","Date","getTime","encodeURIComponent","then","clearTimeout","status","json","result","error","location","href","new_url","renderResult","log","name","image","Component","Result","searchedId","comments","commentsCount","comments_count","text_html","AmplifiedSnippet","ShareSong","showShare","setShowShare","shared","setShared","shareError","setShareError","navigator","share","margin","textAlign","shareData","text","catch","e","finally","fetch","method","err","RenderSongHead","memo","albums","length","albumNames","map","a","year","join","ShowRelated","related","setRelated","setLoading","mounted","loadRelated","ok","categories","_started","loadRelatedDebounced","current","onEnter","category","label","results","ShowRelatedGroup","songs","_url","NotFound"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { Waypoint } from \"react-waypoint\";\nimport { Helmet } from \"react-helmet\";\nimport {\n  Loading,\n  SetHTMLHeaders,\n  isServer,\n  YouTubeSnippet,\n  SpotifySnippet,\n  IntersectionLazy,\n  // loadCarbonScript,\n  loadAdsenseScript,\n  loadAmplifiedScript,\n  RenderParagraphs,\n  ServerError,\n  AmazonRelatedProducts,\n} from \"./Common\";\nimport { cachedFetch } from \"./Cache\";\nimport { SongComments } from \"./Comments\";\n\nimport \"./Song.css\";\n\nconst PUBLIC_URL = process.env.PUBLIC_URL || \"\";\nconst placeholderImage = PUBLIC_URL + \"/static/placeholder.png\";\nconst skullImage = PUBLIC_URL + \"/static/skull.png\";\n\nconst NO_ADS = process.env.REACT_APP_NO_ADS === \"true\";\n\nconst AdTag = (props) => {\n  useEffect(() => {\n    if (window.cf_async === undefined) {\n      window.cf_async = false;\n    }\n    document.getElementById(\"inject_ad\");\n    let unique_part = Math.floor(Math.random() * 999999999);\n    let opts = {\n      artist: props.Artistname,\n      song: props.Songname,\n      adunit_id: 100004858,\n      div_id: \"cf_async_\" + unique_part,\n    };\n    let cf_div = document.createElement(\"div\");\n    cf_div.setAttribute(\"id\", opts.div_id);\n    document\n      .getElementById(\"inject_ad\")\n      .parentNode.setAttribute(\"id\", \"ad_\" + unique_part);\n    document.getElementById(\"ad_\" + unique_part).appendChild(cf_div);\n    let c = function () {\n      cf.showAsyncAd(opts);\n    };\n    if (typeof window.cf !== \"undefined\") c();\n    else {\n      cf_async = !0;\n      let r = document.createElement(\"script\"),\n        s = document.getElementsByTagName(\"script\")[0];\n      r.async = !0;\n      r.src = \"//srv.tunefindforfans.com/fruits/apricots.js\";\n      r.readyState\n        ? (r.onreadystatechange = function () {\n            if (\"loaded\" == r.readyState || \"complete\" == r.readyState)\n              (r.onreadystatechange = null), c();\n          })\n        : (r.onload = c);\n      s.parentNode.insertBefore(r, s);\n    }\n  }, []);\n\n  return (\n    <>\n      <div id=\"inject_ad\"></div>\n    </>\n  );\n};\n\nclass Song extends React.Component {\n  state = {\n    song: this.props.song || null,\n    loading: false,\n    notFound: this.props.songNotFound || false,\n    serverError: null,\n  };\n\n  componentDidMount() {\n    const { match } = this.props;\n    const id = parseInt(match.params.id, 10);\n    if (!this.state.song || this.state.song.id !== id) {\n      if (!this.props.songNotFound) {\n        this.loadSong(id);\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    this.dismounted = true;\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.match.params.id !== prevProps.match.params.id) {\n      this.setState(\n        {\n          song: null,\n          loading: false,\n          notFound: false,\n          serverError: null,\n        },\n        () => {\n          try {\n            localStorage.removeItem(\"searched\");\n          } catch (ex) {\n            console.warn(\"'localStorage.removeItem(\\\"searched\\\")' didn't work\");\n          }\n\n          this.loadSong(this.props.match.params.id);\n        }\n      );\n    }\n  }\n\n  loadSong(id) {\n    SetHTMLHeaders({\n      title: \"Loading... - Song Search\",\n    });\n    if (!isServer) {\n      this.showLoadingSoon = window.setTimeout(() => {\n        if (!this.dismounted) {\n          if (\n            !this.state.serverError &&\n            !this.state.notFound &&\n            !this.state.song &&\n            !this.state.loading\n          ) {\n            this.setState({ loading: true });\n          }\n        }\n      }, 500);\n    }\n\n    let url = `/api/song/${id}`;\n    let searched = null;\n    try {\n      searched = localStorage.getItem(\"searched\");\n    } catch (ex) {\n      console.warn(\"'localStorage.getItem(\\\"searched\\\")' didn't work\");\n    }\n    if (searched) {\n      if (searched.includes(\",\")) {\n        // It *used* to be that what was stored in localStorage.searched was just the\n        // search ID. Then in April 2019 this changed to become `ID,timestamp`.\n        // E.g. '92613,1556152340091'. So, we need to deal with handling both\n        // the new and the old.\n        const timestamp = parseInt(searched.split(\",\")[1], 10);\n        const age = (new Date().getTime() - timestamp) / 1000;\n        if (age > 3600) {\n          searched = null;\n        } else {\n          searched = searched.split(\",\")[0];\n        }\n      }\n      if (searched) {\n        url += `?searched=${encodeURIComponent(searched)}`;\n      }\n    }\n\n    return cachedFetch(url).then((r) => {\n      if (!isServer && this.showLoadingSoon) {\n        window.clearTimeout(this.showLoadingSoon);\n      }\n      if (r.status === 400) {\n        return r.json().then((result) => {\n          this.setState({ loading: false });\n          if (result.error && result.error === \"redirected\") {\n            if (isServer) {\n              this.setState({ notFound: true });\n            } else {\n              document.location.href = result.new_url;\n            }\n          } else {\n            // Some other error\n            this.setState({ serverError: true });\n          }\n        });\n      } else if (r.status === 404) {\n        this.setState({ loading: false, notFound: true });\n        SetHTMLHeaders({ title: \"Not Found\" });\n      } else if (r.status === 500) {\n        this.setState({ loading: false, serverError: true });\n        SetHTMLHeaders({ title: \"Song loading error :(\" });\n      } else {\n        return r.json().then((result) => {\n          if (result && !result.error) {\n            this.renderResult(result);\n          } else if (result && result.error) {\n            console.log(\"ERROR:\", result.error);\n          }\n          // if (searched) {\n          //   localStorage.removeItem(\"searched\");\n          // }\n          return result;\n        });\n      }\n    });\n  }\n\n  renderResult(result) {\n    // Make sure this matches server/render.js\n    let title = `${result.song.name} lyrics by ${result.song.artist.name}`;\n    if (!isServer) {\n      SetHTMLHeaders({\n        title: title,\n        image: result.song.image,\n      });\n    }\n    this.setState({\n      loading: false,\n      song: result.song,\n    });\n  }\n\n  render() {\n    const { loading, song, serverError, notFound } = this.state;\n\n    return (\n      <div>\n        {loading && <Loading text=\"Loading...\" />}\n        {song && <Result song={song} />}\n\n        {serverError && !song && <ServerError />}\n        {notFound && <NotFound />}\n      </div>\n    );\n  }\n}\n\nfunction Result({ song }) {\n  // useEffect(() => {\n  //   // loadCarbonScript();\n  // }, []);\n\n  let searchedId;\n\n  if (!isServer) {\n    let searched = null;\n    try {\n      searched = localStorage.getItem(\"searched\");\n    } catch (ex) {\n      console.warn(\"'localStorage.getItem(\\\"searched\\\")' didn't work\");\n    }\n\n    if (searched) {\n      if (searched.includes(\",\")) {\n        // The new way\n        searchedId = parseInt(searched.split(\",\")[0], 10);\n      } else {\n        // The old way!\n        searchedId = parseInt(searched, 10);\n      }\n    }\n  }\n\n  let comments = null;\n  let commentsCount = null;\n  if (song.comments) {\n    comments = song.comments.comments;\n    commentsCount = song.comments.comments_count;\n  }\n\n  return (\n     <div className=\"result song oka\">\n        <RenderSongHead song={song} />\n        {/* {!NO_ADS ? <div id=\"carbonadsouter\" /> : <span id=\"_nocardonads\" />} */}\n        <RenderParagraphs song={song.id} text={song.text_html} />\n\n        {!NO_ADS && <AmplifiedSnippet song={song} />}\n\n        <SongComments\n          comments={comments}\n          commentsCount={commentsCount}\n          song={song}\n          searchedId={searchedId}\n        />\n        <ShareSong song={song} />\n        <AmazonRelatedProducts song={song} />\n        {!isServer ? (\n          <IntersectionLazy render={() => <SpotifySnippet song={song} />} />\n        ) : null}\n        {!isServer ? (\n          <IntersectionLazy render={() => <YouTubeSnippet song={song} />} />\n        ) : null}\n        {!isServer ? <ShowRelated song={song} /> : null}\n      </div>\n  );\n}\n\nfunction AmplifiedSnippet({ song }) {\n  useEffect(() => {\n    loadAmplifiedScript({ song: song.name, artist: song.artist.name });\n  }, [song]);\n\n  return (\n    <div id=\"amplifiedouter\">\n      <div className=\"null-hide\" id=\"amplified_100003500\" />\n    </div>\n  );\n}\n\nfunction ShareSong({ song }) {\n  const [showShare, setShowShare] = useState(false);\n  const [shared, setShared] = useState(false);\n  const [shareError, setShareError] = useState(null);\n  useEffect(() => {\n    if (navigator.share) {\n      setShowShare(true);\n    }\n  }, []);\n  if (!showShare) return null;\n\n  return (\n    <div style={{ margin: \"30px 0\", textAlign: \"center\" }}>\n      <button\n        className=\"btn btn-primary\"\n        onClick={() => {\n          const shareData = {\n            title: song.name,\n            text: `I found '${song.name}' on Song Search!`,\n            url: window.location.href,\n          };\n          try {\n            navigator\n              .share(shareData)\n              .then(() => {\n                setShared(true);\n                setShareError(null);\n              })\n              .catch((e) => {\n                setShareError(e);\n              })\n              .finally(() => {\n                fetch(`/api/song/${song.id}/shared/`, {\n                  method: \"POST\",\n                });\n              });\n          } catch (err) {\n            setShareError(err);\n          }\n        }}\n      >\n        {shared ? \"Thanks!\" : \"Share this song\"}\n      </button>\n      {shareError && <p>Sharing failed or was canceled. Oh well.</p>}\n    </div>\n  );\n}\n\n// XXX Check if this React.memo works\nconst RenderSongHead = React.memo(({ song }) => {\n  let image = null;\n  if (song.image) {\n    image = (\n      <img\n        src={song.image.url}\n        alt={song.image.name}\n        className=\"song-picture\"\n      />\n    );\n  } else {\n    image = (\n      <img\n        src={placeholderImage}\n        alt={song.artist.name}\n        width={150}\n        height={150}\n      />\n    );\n  }\n  let albums = null;\n  if (song.albums.length) {\n    let albumNames = song.albums\n      .map((a) => {\n        if (a.year) {\n          return `${a.name} (${a.year})`;\n        } else {\n          return a.name;\n        }\n      })\n      .join(\", \");\n    albums = (\n      <h3>\n        <span className=\"by\">on</span> {albumNames}\n      </h3>\n    );\n  }\n  return (\n    <>\n      <div className=\"text-center last\">\n        {image}\n        <h2 className=\"\">{song.name}</h2>\n        <h3>\n          <span className=\"by\">by</span> {song.artist.name}\n        </h3>\n        {albums}\n        <AdTag Songname={song.name} Artistname={song.artist.name} />\n      </div>\n    </>\n  );\n});\n\nconst ShowRelated = React.memo(({ song }) => {\n  const [related, setRelated] = useState(null);\n  const [loading, setLoading] = useState(false);\n\n  const mounted = React.useRef(false);\n\n  useEffect(() => {\n    if (loading && related) {\n      setLoading(false);\n    }\n  }, [related, loading]);\n\n  function loadRelated() {\n    const url = `/api/song/${song.id}/related`;\n    return cachedFetch(url).then((r) => {\n      if (r.ok) {\n        r.json().then((result) => {\n          if (result && result.categories) {\n            setRelated(result.categories);\n          }\n        });\n      }\n    });\n  }\n\n  const _started = useRef();\n\n  function loadRelatedDebounced() {\n    if (!_started.current) {\n      _started.current = new Date().getTime();\n      loadRelated();\n    }\n  }\n\n  function onEnter() {\n    if (!related && !loading) {\n      loadRelatedDebounced();\n    }\n  }\n\n  useEffect(() => {\n    mounted.current = true;\n    return () => {\n      mounted.current = false;\n    };\n  }, []);\n\n  if (related) {\n    if (!related.length) {\n      return null;\n    }\n    return (\n      <div className=\"related\">\n        {related.map((category) => {\n          return (\n            <ShowRelatedGroup\n              key={category.label}\n              label={category.label}\n              songs={category.results}\n            />\n          );\n        })}\n      </div>\n    );\n  } else if (loading) {\n    return null;\n  }\n  return <Waypoint onEnter={onEnter} />;\n});\n\nfunction ShowRelatedGroup({ label, songs }) {\n  return (\n    <div>\n      <h4>{label}</h4>\n      <ul>\n        {songs.map((song) => {\n          return (\n            <li key={song.id}>\n              <Link to={song._url}>\n                <b>{song.name}</b> <span className=\"by\">by</span>{\" \"}\n                {song.artist.name}\n              </Link>\n            </li>\n          );\n        })}\n      </ul>\n    </div>\n  );\n}\n\nfunction NotFound() {\n  return (\n    <div className=\"not-found\">\n      <h3>Song Not Found</h3>\n      <p>\n        <img alt=\"Skull\" src={skullImage} />\n      </p>\n      <p>\n        <Link to=\"/\">Try another search</Link>\n      </p>\n    </div>\n  );\n}\n\nexport default Song;\n"]},"metadata":{},"sourceType":"module"}